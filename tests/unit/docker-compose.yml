version: "3.7"

services:
  build:
    image: xcompany/xbuild:unit
    build:
      context: ../../
    volumes:
      - ../../.devcontainer/build.sh:/build.sh:ro
    command: bash -c /build.sh

  test:
    image: xcompany/xbuild:unit
    depends_on:
      - build
    volumes:
      # Map the current Source Folder
      - ../../tests/unit/:/workspace/tests/unit
    command: /usr/bin/bats /workspace/tests/unit/
